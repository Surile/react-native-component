{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "popover",
  "type": "registry:component",
  "title": "Example popover",
  "author": "@gabimoncha",
  "description": "Displays a button which is always red.",
  "files": [
    {
      "path": "./node_modules/@rnr/example-library/src/components/popover/popover.tsx",
      "content": "import noop from 'lodash/noop';\nimport React, {\n  useState,\n  useRef,\n  useCallback,\n  useMemo,\n  memo,\n  isValidElement,\n  Children,\n  cloneElement,\n} from 'react';\nimport type { View } from 'react-native';\nimport { Platform, ScrollView, TouchableOpacity } from 'react-native';\nimport RNPopoverView from 'react-native-popover-view';\n\nimport type { PopoverProps, PopoverItemProps } from './interface';\nimport { getDefaultValue } from '../../helpers';\n\nconst arrowSize = { width: 0, height: 0 };\n\nconst Popover = <T,>({\n  children,\n  content,\n  dark = false,\n  shadow = false,\n  arrow = true,\n  triggerStyle,\n  onSelect = noop,\n  disabled,\n  renderContentComponent,\n  duration,\n  trigger = 'onPress',\n\n  backgroundStyle,\n  popoverStyle,\n  ...restProps\n}: React.PropsWithChildren<PopoverProps<T>>) => {\n  duration = getDefaultValue(duration, 300);\n\n  const touchable = useRef<View>(null);\n  const [showPopover, setShowPopover] = useState(false);\n  const animationConfig = useMemo(() => ({ duration }), [duration]);\n\n  const openPopover = useCallback(() => {\n    setShowPopover(true);\n  }, []);\n  const closePopover = useCallback(() => {\n    setShowPopover(false);\n  }, []);\n\n  const _onSelect = (value: T, index: number) => {\n    if (onSelect) {\n      onSelect(value, index);\n    }\n\n    closePopover();\n  };\n\n  const renderContent = () => {\n    const items = Children.map(content, (child, index) => {\n      if (!isValidElement(child)) {\n        return child;\n      }\n\n      return cloneElement(child as React.ReactElement<PopoverItemProps<T>>, {\n        onSelect: (v: T) => _onSelect(v, index),\n        dark: dark,\n      });\n    });\n\n    if (typeof renderContentComponent === 'function') {\n      return renderContentComponent(items, closePopover);\n    }\n\n    return <ScrollView>{items}</ScrollView>;\n  };\n\n  return (\n    <>\n      <TouchableOpacity\n        ref={touchable}\n        onPress={trigger === 'onPress' ? openPopover : undefined}\n        onLongPress={trigger === 'onLongPress' ? openPopover : undefined}\n        onPressIn={trigger === 'onPressIn' ? openPopover : undefined}\n        className='items-center'\n        style={triggerStyle}\n        disabled={disabled}\n        activeOpacity={0.8}\n      >\n        {children}\n      </TouchableOpacity>\n      <RNPopoverView\n        {...restProps}\n        from={touchable as any}\n        isVisible={showPopover}\n        backgroundStyle={[\n          {\n            backgroundColor: 'transparent',\n          },\n          backgroundStyle,\n        ]}\n        popoverStyle={[\n          {\n            backgroundColor: 'white',\n            borderRadius: 4,\n            paddingVertical: 0,\n            paddingHorizontal: 0,\n            elevation: 0,\n          },\n          // Android 黑色背景的阴影也是黑色，不友好\n          dark\n            ? {\n                backgroundColor: 'rgba(0,0,0,0.7)',\n              }\n            : null,\n          shadow\n            ? {\n                ...Platform.select({\n                  android: {\n                    elevation: 4,\n                  },\n                  ios: {\n                    shadowColor: '#000',\n                    shadowOpacity: 0.2,\n                    shadowRadius: 4,\n                    shadowOffset: {\n                      width: 0,\n                      height: 0,\n                    },\n                  },\n                }),\n              }\n            : null,\n          popoverStyle,\n        ]}\n        arrowSize={!arrow ? arrowSize : undefined}\n        onRequestClose={closePopover}\n        animationConfig={animationConfig}\n      >\n        {renderContent()}\n      </RNPopoverView>\n    </>\n  );\n};\n\nexport default memo(Popover) as <T>(\n  p: React.PropsWithChildren<PopoverProps<T>>\n) => React.ReactElement;\n",
      "type": "registry:component"
    }
  ]
}